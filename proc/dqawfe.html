<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Modern Fortran QUADPACK">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>dqawfe &ndash; quadpack</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">quadpack </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="sourcefile/quadpack_generic.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>dqawfe
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip"
                 data-bs-placement="bottom" data-html="true"
                 title=" 3.3% of total for procedures.">117 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/quadpack_generic.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/quadpack_generic.f90.html'>quadpack_generic.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/quadpack_generic.html'>quadpack_generic</a></li>
            <li class="breadcrumb-item active" aria-current="page">dqawfe</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dqawfe.html#src">dqawfe</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine dqawfe(f, a, Omega, Integr, Epsabs, Limlst, Limit, Maxp1, Result, Abserr, Neval, Ier, Rslst, Erlst, Ierlst, Lst, Alist, Blist, Rlist, Elist, Iord, Nnlog, Chebmo)  
</h2>
    

    <p>same as <a href="../proc/dqawf.html">dqawf</a> but provides more information and control</p>
<p>the routine calculates an approximation result to a
  given fourier integral
  i = integral of <code>f(x)*w(x)</code> over <code>(a,infinity)</code>
  where <code>w(x)=cos(omega*x)</code> or <code>w(x)=sin(omega*x)</code>,
  hopefully satisfying following claim for accuracy
  <code>abs(i-result)&lt;=epsabs</code>.</p>
<h3>History</h3>
<ul>
<li>QUADPACK: date written 800101, revision date 830518 (yymmdd)</li>
</ul>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-f~12"></span>
              procedure(func)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>f</strong></td>
            <td>
                <p>function subprogram defining the integrand function <code>f(x)</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-a~11"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>a</strong></td>
            <td>
                <p>lower limit of integration</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omega~2"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Omega</strong></td>
            <td>
                <p>parameter in the weight function</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-integr~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Integr</strong></td>
            <td>
                <p>indicates which weight function is used:</p>
<ul>
<li>integr = 1  <code>w(x) = cos(omega*x)</code></li>
<li>integr = 2  <code>w(x) = sin(omega*x)</code></li>
</ul>
<p>if <code>integr/=1.and.integr/=2</code>, the routine will
end with ier = 6.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-epsabs~12"></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Epsabs</strong></td>
            <td>
                <p>absolute accuracy requested, <code>epsabs&gt;0</code>
if <code>epsabs&lt;=0</code>, the routine will end with ier = 6.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-limlst~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Limlst</strong></td>
            <td>
                <p>limlst gives an upper bound on the number of
cycles, <code>limlst&gt;=1</code>.
if <code>limlst&lt;3</code>, the routine will end with ier = 6.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-limit~10"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Limit</strong></td>
            <td>
                <p>gives an upper bound on the number of subintervals
allowed in the partition of each cycle, <code>limit&gt;=1</code>
each cycle, <code>limit&gt;=1</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxp1~2"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Maxp1</strong></td>
            <td>
                <p>gives an upper bound on the number of
chebyshev moments which can be stored, i.e.
for the intervals of lengths
<code>abs(b-a)*2**(-l),</code>l=0,1, ..., maxp1-2, maxp1&gt;=1``</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-result~12"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Result</strong></td>
            <td>
                <p>approximation to the integral <code>x</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-abserr~12"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Abserr</strong></td>
            <td>
                <p>estimate of the modulus of the absolute error,
which should equal or exceed <code>abs(i-result)</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-neval~12"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Neval</strong></td>
            <td>
                <p>number of integrand evaluations</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ier~12"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ier</strong></td>
            <td>
                <ul>
<li>ier = 0 normal and reliable termination of
  the routine. it is assumed that the
  requested accuracy has been achieved.</li>
<li>ier&gt;0 abnormal termination of the routine. the
  estimates for integral and error are less
  reliable. it is assumed that the requested
  accuracy has not been achieved.</li>
</ul>
<p>error messages:</p>
<p>if <code>omega/=0</code>:</p>
<ul>
<li>ier = 1 maximum number of <code>cycles</code> allowed
  has been achieved., i.e. of subintervals
  <code>(a+(k-1)c,a+kc)</code> where
  <code>c = (2*int(abs(omega))+1)*pi/abs(omega)</code>,
  for <code>k = 1, 2, ..., lst</code>.
  one can allow more cycles by increasing
  the value of limlst (and taking the
  according dimension adjustments into
  account).
  examine the array <code>iwork</code> which contains
  the error flags on the cycles, in order to
  look for eventual local integration
  difficulties. if the position of a local
  difficulty can be determined (e.g.
  singularity, discontinuity within the
  interval) one will probably gain from
  splitting up the interval at this point
  and calling appropriate integrators on
  the subranges.</li>
<li>ier = 4 the extrapolation table constructed for
  convergence acceleration of the series
  formed by the integral contributions over
  the cycles, does not converge to within
  the requested accuracy. as in the case of
  ier = 1, it is advised to examine the
  array <code>iwork</code> which contains the error
  flags on the cycles.</li>
<li>ier = 6 the input is invalid because
  (<code>integr/=1</code> and <code>integr/=2</code>) or
  <code>epsabs&lt;=0</code> or <code>limlst&lt;3</code>.
  <code>result</code>, <code>abserr</code>, <code>neval</code>, <code>lst</code> are set
  to zero.</li>
<li>
<p>ier = 7 bad integrand behaviour occurs within one
  or more of the cycles. location and type
  of the difficulty involved can be
  determined from the vector <code>ierlst</code>. here
  <code>lst</code> is the number of cycles actually
  needed (see below):</p>
</li>
<li>
<p>ierlst(k) = 1 the maximum number of
     subdivisions (= <code>limit</code>) has
     been achieved on the <code>k</code>th
     cycle.</p>
</li>
<li>ierlst(k) = 2 occurrence of roundoff error
     is detected and prevents the
     tolerance imposed on the
     <code>k</code>th cycle, from being
     achieved.</li>
<li>ierlst(k) = 3 extremely bad integrand
     behaviour occurs at some
     points of the <code>k</code>th cycle.</li>
<li>ierlst(k) = 4 the integration procedure
     over the <code>k</code>th cycle does
     not converge (to within the
     required accuracy) due to
     roundoff in the
     extrapolation procedure
     invoked on this cycle. it
     is assumed that the result
     on this interval is the
     best which can be obtained.</li>
<li>ierlst(k) = 5 the integral over the <code>k</code>th
     cycle is probably divergent
     or slowly convergent. it
     must be noted that
     divergence can occur with
     any other value of
     <code>ierlst(k)</code>.</li>
</ul>
<p>if <code>omega = 0</code> and <code>integr = 1</code>,
the integral is calculated by means of <a href="../proc/dqagie.html">dqagie</a>
and <code>ier = ierlst(1)</code> (with meaning as described
for <code>ierlst(k), k = 1</code>).</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rslst"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rslst</strong>(Limlst)</td>
            <td>
                <p>vector of dimension at least <code>limlst</code>
<code>rslst(k)</code> contains the integral contribution
over the interval <code>(a+(k-1)c,a+kc)</code> where
<code>c = (2*int(abs(omega))+1)*pi/abs(omega)</code>,
<code>k = 1, 2, ..., lst</code>.
note that, if <code>omega = 0</code>, <code>rslst(1)</code> contains
the value of the integral over <code>(a,infinity)</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-erlst"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Erlst</strong>(Limlst)</td>
            <td>
                <p>vector of dimension at least <code>limlst</code>
<code>erlst(k)</code> contains the error estimate corresponding
with <code>rslst(k)</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ierlst"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Ierlst</strong>(Limlst)</td>
            <td>
                <p>vector of dimension at least <code>limlst</code>
<code>ierlst(k)</code> contains the error flag corresponding
with <code>rslst(k)</code>. for the meaning of the local error
flags see description of output parameter <code>ier</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lst~2"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Lst</strong></td>
            <td>
                <p>number of subintervals needed for the integration
if <code>omega = 0</code> then lst is set to 1.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-alist~6"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Alist</strong>(Limit)</td>
            <td>
                <p>vector of dimension at least <code>limit</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-blist~6"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Blist</strong>(Limit)</td>
            <td>
                <p>vector of dimension at least <code>limit</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rlist~6"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Rlist</strong>(Limit)</td>
            <td>
                <p>vector of dimension at least <code>limit</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-elist~6"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Elist</strong>(Limit)</td>
            <td>
                <p>vector of dimension at least <code>limit</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iord~6"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Iord</strong>(Limit)</td>
            <td>
                <p>vector of dimension at least <code>limit</code>, providing
space for the quantities needed in the subdivision
process of each cycle</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nnlog"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Nnlog</strong>(Limit)</td>
            <td>
                <p>vector of dimension at least <code>limit</code>, providing
space for the quantities needed in the subdivision
process of each cycle</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-chebmo"></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>Chebmo</strong>(Maxp1,25)</td>
            <td>
                <p>array of dimension at least <code>(maxp1,25)</code>, providing
space for the chebyshev moments needed within the
cycles (see also routine <a href="../proc/dqc25f.html">dqc25f</a>)</p>
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Calls</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dqawfe~~CallsGraph Pages: 1 -->
<svg id="procdqawfeCallsGraph" width="641pt" height="81pt"
 viewBox="0.00 0.00 641.00 81.41" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dqawfe~~CallsGraph" class="graph" transform="scale(1.17 1.17) rotate(0) translate(4 91)">
<title>proc~~dqawfe~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-91 744,-91 744,4 -4,4"/>
<!-- proc~dqawfe -->
<g id="proc~~dqawfe~~CallsGraph_node1" class="node">
<title>proc~dqawfe</title>
<polygon fill="none" stroke="black" points="157,-66 0,-66 0,-42 157,-42 157,-66"/>
<text text-anchor="middle" x="78.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50">quadpack_generic::dqawfe</text>
</g>
<!-- proc~dqagie -->
<g id="proc~~dqawfe~~CallsGraph_node2" class="node">
<title>proc~dqagie</title>
<g id="a_proc~~dqawfe~~CallsGraph_node2"><a xlink:href="../proc/dqagie.html" xlink:title="quadpack_generic::dqagie">
<polygon fill="#d9534f" stroke="#d9534f" points="350.5,-87 195.5,-87 195.5,-63 350.5,-63 350.5,-87"/>
<text text-anchor="middle" x="273" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqagie</text>
</a>
</g>
</g>
<!-- proc~dqawfe&#45;&gt;proc~dqagie -->
<g id="proc~~dqawfe~~CallsGraph_edge1" class="edge">
<title>proc~dqawfe&#45;&gt;proc~dqagie</title>
<path fill="none" stroke="#000000" d="M157.24,-62.48C166.44,-63.48 175.87,-64.51 185.18,-65.53"/>
<polygon fill="#000000" stroke="#000000" points="184.9,-69.02 195.22,-66.62 185.66,-62.06 184.9,-69.02"/>
</g>
<!-- proc~dqawoe -->
<g id="proc~~dqawfe~~CallsGraph_node3" class="node">
<title>proc~dqawoe</title>
<g id="a_proc~~dqawfe~~CallsGraph_node3"><a xlink:href="../proc/dqawoe.html" xlink:title="quadpack_generic::dqawoe">
<polygon fill="#d9534f" stroke="#d9534f" points="353,-45 193,-45 193,-21 353,-21 353,-45"/>
<text text-anchor="middle" x="273" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqawoe</text>
</a>
</g>
</g>
<!-- proc~dqawfe&#45;&gt;proc~dqawoe -->
<g id="proc~~dqawfe~~CallsGraph_edge2" class="edge">
<title>proc~dqawfe&#45;&gt;proc~dqawoe</title>
<path fill="none" stroke="#000000" d="M157.24,-45.52C165.64,-44.6 174.24,-43.66 182.76,-42.74"/>
<polygon fill="#000000" stroke="#000000" points="183.15,-46.21 192.71,-41.65 182.39,-39.25 183.15,-46.21"/>
</g>
<!-- proc~dqk15i -->
<g id="proc~~dqawfe~~CallsGraph_node5" class="node">
<title>proc~dqk15i</title>
<g id="a_proc~~dqawfe~~CallsGraph_node5"><a xlink:href="../proc/dqk15i.html" xlink:title="quadpack_generic::dqk15i">
<polygon fill="#d9534f" stroke="#d9534f" points="543.5,-87 389.5,-87 389.5,-63 543.5,-63 543.5,-87"/>
<text text-anchor="middle" x="466.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqk15i</text>
</a>
</g>
</g>
<!-- proc~dqagie&#45;&gt;proc~dqk15i -->
<g id="proc~~dqawfe~~CallsGraph_edge3" class="edge">
<title>proc~dqagie&#45;&gt;proc~dqk15i</title>
<path fill="none" stroke="#000000" d="M350.51,-75C359.92,-75 369.59,-75 379.13,-75"/>
<polygon fill="#000000" stroke="#000000" points="379.42,-78.5 389.42,-75 379.42,-71.5 379.42,-78.5"/>
</g>
<!-- proc~dqc25f -->
<g id="proc~~dqawfe~~CallsGraph_node4" class="node">
<title>proc~dqc25f</title>
<g id="a_proc~~dqawfe~~CallsGraph_node4"><a xlink:href="../proc/dqc25f.html" xlink:title="quadpack_generic::dqc25f">
<polygon fill="#d9534f" stroke="#d9534f" points="544,-45 389,-45 389,-21 544,-21 544,-45"/>
<text text-anchor="middle" x="466.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqc25f</text>
</a>
</g>
</g>
<!-- proc~dqawoe&#45;&gt;proc~dqc25f -->
<g id="proc~~dqawfe~~CallsGraph_edge4" class="edge">
<title>proc~dqawoe&#45;&gt;proc~dqc25f</title>
<path fill="none" stroke="#000000" d="M353.27,-33C361.61,-33 370.12,-33 378.54,-33"/>
<polygon fill="#000000" stroke="#000000" points="378.75,-36.5 388.75,-33 378.75,-29.5 378.75,-36.5"/>
</g>
<!-- proc~dqcheb -->
<g id="proc~~dqawfe~~CallsGraph_node6" class="node">
<title>proc~dqcheb</title>
<g id="a_proc~~dqawfe~~CallsGraph_node6"><a xlink:href="../proc/dqcheb.html" xlink:title="quadpack_generic::dqcheb">
<polygon fill="#d9534f" stroke="#d9534f" points="739,-66 581,-66 581,-42 739,-42 739,-66"/>
<text text-anchor="middle" x="660" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqcheb</text>
</a>
</g>
</g>
<!-- proc~dqc25f&#45;&gt;proc~dqcheb -->
<g id="proc~~dqawfe~~CallsGraph_edge5" class="edge">
<title>proc~dqc25f&#45;&gt;proc~dqcheb</title>
<path fill="none" stroke="#000000" d="M544.01,-41.39C552.79,-42.35 561.8,-43.34 570.72,-44.32"/>
<polygon fill="#000000" stroke="#000000" points="570.41,-47.81 580.73,-45.42 571.17,-40.85 570.41,-47.81"/>
</g>
<!-- proc~dqk15w -->
<g id="proc~~dqawfe~~CallsGraph_node7" class="node">
<title>proc~dqk15w</title>
<g id="a_proc~~dqawfe~~CallsGraph_node7"><a xlink:href="../proc/dqk15w.html" xlink:title="quadpack_generic::dqk15w">
<polygon fill="#d9534f" stroke="#d9534f" points="740,-24 580,-24 580,0 740,0 740,-24"/>
<text text-anchor="middle" x="660" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqk15w</text>
</a>
</g>
</g>
<!-- proc~dqc25f&#45;&gt;proc~dqk15w -->
<g id="proc~~dqawfe~~CallsGraph_edge6" class="edge">
<title>proc~dqc25f&#45;&gt;proc~dqk15w</title>
<path fill="none" stroke="#000000" d="M544.01,-24.61C552.47,-23.68 561.14,-22.73 569.74,-21.79"/>
<polygon fill="#000000" stroke="#000000" points="570.23,-25.26 579.79,-20.69 569.47,-18.3 570.23,-25.26"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocdqawfeCallsGraph = svgPanZoom('#procdqawfeCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.16 1.16) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
  <h3 class="card-title">Called by</h3>
      </div>
      <div class="card-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dqawfe~~CalledByGraph Pages: 1 -->
<svg id="procdqawfeCalledByGraph" width="352pt" height="32pt"
 viewBox="0.00 0.00 352.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dqawfe~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dqawfe~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 348,-28 348,4 -4,4"/>
<!-- proc~dqawfe -->
<g id="proc~~dqawfe~~CalledByGraph_node1" class="node">
<title>proc~dqawfe</title>
<polygon fill="none" stroke="black" points="344,-24 187,-24 187,0 344,0 344,-24"/>
<text text-anchor="middle" x="265.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">quadpack_generic::dqawfe</text>
</g>
<!-- proc~dqawf -->
<g id="proc~~dqawfe~~CalledByGraph_node2" class="node">
<title>proc~dqawf</title>
<g id="a_proc~~dqawfe~~CalledByGraph_node2"><a xlink:href="../proc/dqawf.html" xlink:title="quadpack_generic::dqawf">
<polygon fill="#d9534f" stroke="#d9534f" points="151,-24 0,-24 0,0 151,0 151,-24"/>
<text text-anchor="middle" x="75.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quadpack_generic::dqawf</text>
</a>
</g>
</g>
<!-- proc~dqawf&#45;&gt;proc~dqawfe -->
<g id="proc~~dqawfe~~CalledByGraph_edge1" class="edge">
<title>proc~dqawf&#45;&gt;proc~dqawfe</title>
<path fill="none" stroke="#000000" d="M151.07,-12C159.55,-12 168.24,-12 176.86,-12"/>
<polygon fill="#000000" stroke="#000000" points="176.93,-15.5 186.93,-12 176.93,-8.5 176.93,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.16 1.16) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">dqawfe</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">Omega</span><span class="p">,</span><span class="w"> </span><span class="n">Integr</span><span class="p">,</span><span class="w"> </span><span class="n">Epsabs</span><span class="p">,</span><span class="w"> </span><span class="n">Limlst</span><span class="p">,</span><span class="w"> </span><span class="n">Limit</span><span class="p">,</span><span class="w"> </span><span class="n">Maxp1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="k">Result</span><span class="p">,</span><span class="w"> </span><span class="n">Abserr</span><span class="p">,</span><span class="w"> </span><span class="n">Neval</span><span class="p">,</span><span class="w"> </span><span class="n">Ier</span><span class="p">,</span><span class="w"> </span><span class="n">Rslst</span><span class="p">,</span><span class="w"> </span><span class="n">Erlst</span><span class="p">,</span><span class="w"> </span><span class="n">Ierlst</span><span class="p">,</span><span class="w"> </span><span class="n">Lst</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">Alist</span><span class="p">,</span><span class="w"> </span><span class="n">Blist</span><span class="p">,</span><span class="w"> </span><span class="n">Rlist</span><span class="p">,</span><span class="w"> </span><span class="n">Elist</span><span class="p">,</span><span class="w"> </span><span class="n">Iord</span><span class="p">,</span><span class="w"> </span><span class="n">Nnlog</span><span class="p">,</span><span class="w"> </span><span class="n">Chebmo</span><span class="p">)</span>
<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        procedure</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="c">!! function subprogram defining the integrand function `f(x)`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">!! lower limit of integration</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Omega</span><span class="w"> </span><span class="c">!! parameter in the weight function</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Integr</span><span class="w"> </span><span class="c">!! indicates which weight function is used:</span>
<span class="w">                                      </span><span class="c">!!</span>
<span class="w">                                      </span><span class="c">!! * integr = 1  `w(x) = cos(omega*x)`</span>
<span class="w">                                      </span><span class="c">!! * integr = 2  `w(x) = sin(omega*x)`</span>
<span class="w">                                      </span><span class="c">!!</span>
<span class="w">                                      </span><span class="c">!! if `integr/=1.and.integr/=2`, the routine will</span>
<span class="w">                                      </span><span class="c">!! end with ier = 6.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Epsabs</span><span class="w"> </span><span class="c">!! absolute accuracy requested, `epsabs&gt;0`</span>
<span class="w">                                       </span><span class="c">!! if `epsabs&lt;=0`, the routine will end with ier = 6.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Limlst</span><span class="w"> </span><span class="c">!! limlst gives an upper bound on the number of</span>
<span class="w">                                      </span><span class="c">!! cycles, `limlst&gt;=1`.</span>
<span class="w">                                      </span><span class="c">!! if `limlst&lt;3`, the routine will end with ier = 6.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Limit</span><span class="w"> </span><span class="c">!! gives an upper bound on the number of subintervals</span>
<span class="w">                                     </span><span class="c">!! allowed in the partition of each cycle, `limit&gt;=1`</span>
<span class="w">                                     </span><span class="c">!! each cycle, `limit&gt;=1`.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Maxp1</span><span class="w"> </span><span class="c">!! gives an upper bound on the number of</span>
<span class="w">                                     </span><span class="c">!! chebyshev moments which can be stored, i.e.</span>
<span class="w">                                     </span><span class="c">!! for the intervals of lengths</span>
<span class="w">                                     </span><span class="c">!! `abs(b-a)*2**(-l), `l=0,1, ..., maxp1-2, maxp1&gt;=1``</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="k">Result</span><span class="w"> </span><span class="c">!! approximation to the integral `x`</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Abserr</span><span class="w"> </span><span class="c">!! estimate of the modulus of the absolute error,</span>
<span class="w">                                        </span><span class="c">!! which should equal or exceed `abs(i-result)`</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Neval</span><span class="w"> </span><span class="c">!! number of integrand evaluations</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ier</span><span class="w"> </span><span class="c">!! * ier = 0 normal and reliable termination of</span>
<span class="w">                                    </span><span class="c">!!   the routine. it is assumed that the</span>
<span class="w">                                    </span><span class="c">!!   requested accuracy has been achieved.</span>
<span class="w">                                    </span><span class="c">!! * ier&gt;0 abnormal termination of the routine. the</span>
<span class="w">                                    </span><span class="c">!!   estimates for integral and error are less</span>
<span class="w">                                    </span><span class="c">!!   reliable. it is assumed that the requested</span>
<span class="w">                                    </span><span class="c">!!   accuracy has not been achieved.</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!! error messages:</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!! if `omega/=0`:</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!! * ier = 1 maximum number of `cycles` allowed</span>
<span class="w">                                    </span><span class="c">!!   has been achieved., i.e. of subintervals</span>
<span class="w">                                    </span><span class="c">!!   `(a+(k-1)c,a+kc)` where</span>
<span class="w">                                    </span><span class="c">!!   `c = (2*int(abs(omega))+1)*pi/abs(omega)`,</span>
<span class="w">                                    </span><span class="c">!!   for `k = 1, 2, ..., lst`.</span>
<span class="w">                                    </span><span class="c">!!   one can allow more cycles by increasing</span>
<span class="w">                                    </span><span class="c">!!   the value of limlst (and taking the</span>
<span class="w">                                    </span><span class="c">!!   according dimension adjustments into</span>
<span class="w">                                    </span><span class="c">!!   account).</span>
<span class="w">                                    </span><span class="c">!!   examine the array `iwork` which contains</span>
<span class="w">                                    </span><span class="c">!!   the error flags on the cycles, in order to</span>
<span class="w">                                    </span><span class="c">!!   look for eventual local integration</span>
<span class="w">                                    </span><span class="c">!!   difficulties. if the position of a local</span>
<span class="w">                                    </span><span class="c">!!   difficulty can be determined (e.g.</span>
<span class="w">                                    </span><span class="c">!!   singularity, discontinuity within the</span>
<span class="w">                                    </span><span class="c">!!   interval) one will probably gain from</span>
<span class="w">                                    </span><span class="c">!!   splitting up the interval at this point</span>
<span class="w">                                    </span><span class="c">!!   and calling appropriate integrators on</span>
<span class="w">                                    </span><span class="c">!!   the subranges.</span>
<span class="w">                                    </span><span class="c">!! * ier = 4 the extrapolation table constructed for</span>
<span class="w">                                    </span><span class="c">!!   convergence acceleration of the series</span>
<span class="w">                                    </span><span class="c">!!   formed by the integral contributions over</span>
<span class="w">                                    </span><span class="c">!!   the cycles, does not converge to within</span>
<span class="w">                                    </span><span class="c">!!   the requested accuracy. as in the case of</span>
<span class="w">                                    </span><span class="c">!!   ier = 1, it is advised to examine the</span>
<span class="w">                                    </span><span class="c">!!   array `iwork` which contains the error</span>
<span class="w">                                    </span><span class="c">!!   flags on the cycles.</span>
<span class="w">                                    </span><span class="c">!! * ier = 6 the input is invalid because</span>
<span class="w">                                    </span><span class="c">!!   (`integr/=1` and `integr/=2`) or</span>
<span class="w">                                    </span><span class="c">!!   `epsabs&lt;=0` or `limlst&lt;3`.</span>
<span class="w">                                    </span><span class="c">!!   `result`, `abserr`, `neval`, `lst` are set</span>
<span class="w">                                    </span><span class="c">!!   to zero.</span>
<span class="w">                                    </span><span class="c">!! * ier = 7 bad integrand behaviour occurs within one</span>
<span class="w">                                    </span><span class="c">!!   or more of the cycles. location and type</span>
<span class="w">                                    </span><span class="c">!!   of the difficulty involved can be</span>
<span class="w">                                    </span><span class="c">!!   determined from the vector `ierlst`. here</span>
<span class="w">                                    </span><span class="c">!!   `lst` is the number of cycles actually</span>
<span class="w">                                    </span><span class="c">!!   needed (see below):</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!!    * ierlst(k) = 1 the maximum number of</span>
<span class="w">                                    </span><span class="c">!!      subdivisions (= `limit`) has</span>
<span class="w">                                    </span><span class="c">!!      been achieved on the `k`th</span>
<span class="w">                                    </span><span class="c">!!      cycle.</span>
<span class="w">                                    </span><span class="c">!!    * ierlst(k) = 2 occurrence of roundoff error</span>
<span class="w">                                    </span><span class="c">!!      is detected and prevents the</span>
<span class="w">                                    </span><span class="c">!!      tolerance imposed on the</span>
<span class="w">                                    </span><span class="c">!!      `k`th cycle, from being</span>
<span class="w">                                    </span><span class="c">!!      achieved.</span>
<span class="w">                                    </span><span class="c">!!    * ierlst(k) = 3 extremely bad integrand</span>
<span class="w">                                    </span><span class="c">!!      behaviour occurs at some</span>
<span class="w">                                    </span><span class="c">!!      points of the `k`th cycle.</span>
<span class="w">                                    </span><span class="c">!!    * ierlst(k) = 4 the integration procedure</span>
<span class="w">                                    </span><span class="c">!!      over the `k`th cycle does</span>
<span class="w">                                    </span><span class="c">!!      not converge (to within the</span>
<span class="w">                                    </span><span class="c">!!      required accuracy) due to</span>
<span class="w">                                    </span><span class="c">!!      roundoff in the</span>
<span class="w">                                    </span><span class="c">!!      extrapolation procedure</span>
<span class="w">                                    </span><span class="c">!!      invoked on this cycle. it</span>
<span class="w">                                    </span><span class="c">!!      is assumed that the result</span>
<span class="w">                                    </span><span class="c">!!      on this interval is the</span>
<span class="w">                                    </span><span class="c">!!      best which can be obtained.</span>
<span class="w">                                    </span><span class="c">!!    * ierlst(k) = 5 the integral over the `k`th</span>
<span class="w">                                    </span><span class="c">!!      cycle is probably divergent</span>
<span class="w">                                    </span><span class="c">!!      or slowly convergent. it</span>
<span class="w">                                    </span><span class="c">!!      must be noted that</span>
<span class="w">                                    </span><span class="c">!!      divergence can occur with</span>
<span class="w">                                    </span><span class="c">!!      any other value of</span>
<span class="w">                                    </span><span class="c">!!      `ierlst(k)`.</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!! if `omega = 0` and `integr = 1`,</span>
<span class="w">                                    </span><span class="c">!! the integral is calculated by means of [[dqagie]]</span>
<span class="w">                                    </span><span class="c">!! and `ier = ierlst(1)` (with meaning as described</span>
<span class="w">                                    </span><span class="c">!! for `ierlst(k), k = 1`).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Rslst</span><span class="p">(</span><span class="n">Limlst</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limlst`</span>
<span class="w">                                               </span><span class="c">!! `rslst(k)` contains the integral contribution</span>
<span class="w">                                               </span><span class="c">!! over the interval `(a+(k-1)c,a+kc)` where</span>
<span class="w">                                               </span><span class="c">!! `c = (2*int(abs(omega))+1)*pi/abs(omega)`,</span>
<span class="w">                                               </span><span class="c">!! `k = 1, 2, ..., lst`.</span>
<span class="w">                                               </span><span class="c">!! note that, if `omega = 0`, `rslst(1)` contains</span>
<span class="w">                                               </span><span class="c">!! the value of the integral over `(a,infinity)`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Erlst</span><span class="p">(</span><span class="n">Limlst</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limlst`</span>
<span class="w">                                               </span><span class="c">!! `erlst(k)` contains the error estimate corresponding</span>
<span class="w">                                               </span><span class="c">!! with `rslst(k)`.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Ierlst</span><span class="p">(</span><span class="n">Limlst</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limlst`</span>
<span class="w">                                               </span><span class="c">!! `ierlst(k)` contains the error flag corresponding</span>
<span class="w">                                               </span><span class="c">!! with `rslst(k)`. for the meaning of the local error</span>
<span class="w">                                               </span><span class="c">!! flags see description of output parameter `ier`.</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Lst</span><span class="w"> </span><span class="c">!! number of subintervals needed for the integration</span>
<span class="w">                                    </span><span class="c">!! if `omega = 0` then lst is set to 1.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Alist</span><span class="p">(</span><span class="n">Limit</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limit`</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Blist</span><span class="p">(</span><span class="n">Limit</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limit`</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Rlist</span><span class="p">(</span><span class="n">Limit</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limit`</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Elist</span><span class="p">(</span><span class="n">Limit</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limit`</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Iord</span><span class="p">(</span><span class="n">Limit</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limit`, providing</span>
<span class="w">                                            </span><span class="c">!! space for the quantities needed in the subdivision</span>
<span class="w">                                            </span><span class="c">!! process of each cycle</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Nnlog</span><span class="p">(</span><span class="n">Limit</span><span class="p">)</span><span class="w"> </span><span class="c">!! vector of dimension at least `limit`, providing</span>
<span class="w">                                             </span><span class="c">!! space for the quantities needed in the subdivision</span>
<span class="w">                                             </span><span class="c">!! process of each cycle</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">Chebmo</span><span class="p">(</span><span class="n">Maxp1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="c">!! array of dimension at least `(maxp1,25)`, providing</span>
<span class="w">                                                   </span><span class="c">!! space for the chebyshev moments needed within the</span>
<span class="w">                                                   </span><span class="c">!! cycles (see also routine [[dqc25f]])</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">abseps</span><span class="p">,</span><span class="w"> </span><span class="n">correc</span><span class="p">,</span><span class="w"> </span><span class="n">dl</span><span class="p">,</span><span class="w"> </span><span class="n">dla</span><span class="p">,</span><span class="w"> </span><span class="n">drl</span><span class="p">,</span><span class="w"> </span><span class="n">ep</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">fact</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">reseps</span><span class="p">,</span><span class="w"> </span><span class="n">res3la</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ktmin</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">,</span><span class="w"> </span><span class="n">ll</span><span class="p">,</span><span class="w"> </span><span class="n">momcom</span><span class="p">,</span><span class="w"> </span><span class="n">nev</span><span class="p">,</span><span class="w"> </span><span class="n">nres</span><span class="p">,</span><span class="w"> </span><span class="n">numrl2</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">psum</span><span class="p">(</span><span class="n">limexp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c">!! `psum` contains the part of the epsilon table</span>
<span class="w">                                     </span><span class="c">!! which is still needed for further computations.</span>
<span class="w">                                     </span><span class="c">!! each element of `psum` is a partial sum of the</span>
<span class="w">                                     </span><span class="c">!! series which should sum to the value of the</span>
<span class="w">                                     </span><span class="c">!! integral.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="c">!! end points of subinterval (of length cycle)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="k">cycle</span><span class="w"> </span><span class="c">!! `(2*int(abs(omega))+1)*pi/abs(omega)`</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errsum</span><span class="w">  </span><span class="c">!! sum of error estimates over the subintervals,</span>
<span class="w">                            </span><span class="c">!! calculated cumulatively</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">epsa</span><span class="w"> </span><span class="c">!! absolute tolerance requested over current</span>
<span class="w">                         </span><span class="c">!! subinterval</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9_wp</span>

<span class="w">        </span><span class="c">! test on validity of parameters</span>

<span class="w">        </span><span class="k">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">        </span><span class="n">Abserr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">        </span><span class="n">Neval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Lst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Ier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">Integr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">Integr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">Epsabs</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">            </span><span class="n">Limlst</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">Ier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ier</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>

<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">Omega</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">            </span><span class="c">! integration by dqagie if omega is zero</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Integr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dqagie</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Epsabs</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">Limit</span><span class="p">,</span><span class="w"> </span><span class="k">Result</span><span class="p">,</span><span class="w"> </span><span class="n">Abserr</span><span class="p">,</span><span class="w"> </span><span class="n">Neval</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">Ier</span><span class="p">,</span><span class="w"> </span><span class="n">Alist</span><span class="p">,</span><span class="w"> </span><span class="n">Blist</span><span class="p">,</span><span class="w"> </span><span class="n">Rlist</span><span class="p">,</span><span class="w"> </span><span class="n">Elist</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                            </span><span class="n">Iord</span><span class="p">,</span><span class="w"> </span><span class="n">last</span><span class="p">)</span>
<span class="w">            </span><span class="n">Rslst</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">Result</span>
<span class="k">            </span><span class="n">Erlst</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Abserr</span>
<span class="w">            </span><span class="n">Ierlst</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ier</span>
<span class="w">            </span><span class="n">Lst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">return</span>
<span class="k">        end if</span>

<span class="k">        </span><span class="n">main</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">block</span>

<span class="w">            </span><span class="c">! initializations</span>

<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">Omega</span><span class="p">)</span>
<span class="w">            </span><span class="n">dl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dl</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">Omega</span><span class="p">)</span>
<span class="w">            </span><span class="n">Ier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">ktmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">Neval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">numrl2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">nres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span>
<span class="w">            </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">cycle</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span>
<span class="w">            </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">p</span>
<span class="w">            </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Epsabs</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Epsabs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">uflow</span><span class="o">/</span><span class="n">p1</span><span class="p">)</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Epsabs</span><span class="o">*</span><span class="n">p1</span>
<span class="w">            </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span>
<span class="w">            </span><span class="n">fact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">            </span><span class="n">correc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">            </span><span class="n">Abserr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>
<span class="w">            </span><span class="n">errsum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span>

<span class="w">            </span><span class="c">! main do-loop</span>

<span class="w">            </span><span class="k">do </span><span class="n">Lst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Limlst</span>

<span class="w">                </span><span class="c">! integrate over current subinterval.</span>

<span class="w">                </span><span class="n">dla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lst</span>
<span class="w">                </span><span class="n">epsa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="n">fact</span>
<span class="w">                </span><span class="k">call </span><span class="n">dqawoe</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">c1</span><span class="p">,</span><span class="w"> </span><span class="n">c2</span><span class="p">,</span><span class="w"> </span><span class="n">Omega</span><span class="p">,</span><span class="w"> </span><span class="n">Integr</span><span class="p">,</span><span class="w"> </span><span class="n">epsa</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">,</span><span class="w"> </span><span class="n">Limit</span><span class="p">,</span><span class="w"> </span><span class="n">Lst</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">Maxp1</span><span class="p">,</span><span class="w"> </span><span class="n">Rslst</span><span class="p">(</span><span class="n">Lst</span><span class="p">),</span><span class="w"> </span><span class="n">Erlst</span><span class="p">(</span><span class="n">Lst</span><span class="p">),</span><span class="w"> </span><span class="n">nev</span><span class="p">,</span><span class="w"> </span><span class="n">Ierlst</span><span class="p">(</span><span class="n">Lst</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">last</span><span class="p">,</span><span class="w"> </span><span class="n">Alist</span><span class="p">,</span><span class="w"> </span><span class="n">Blist</span><span class="p">,</span><span class="w"> </span><span class="n">Rlist</span><span class="p">,</span><span class="w"> </span><span class="n">Elist</span><span class="p">,</span><span class="w"> </span><span class="n">Iord</span><span class="p">,</span><span class="w"> </span><span class="n">Nnlog</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">momcom</span><span class="p">,</span><span class="w"> </span><span class="n">Chebmo</span><span class="p">)</span>
<span class="w">                </span><span class="n">Neval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Neval</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nev</span>
<span class="w">                </span><span class="n">fact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fact</span><span class="o">*</span><span class="n">p</span>
<span class="w">                </span><span class="n">errsum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Erlst</span><span class="p">(</span><span class="n">Lst</span><span class="p">)</span>
<span class="w">                </span><span class="n">drl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">Rslst</span><span class="p">(</span><span class="n">Lst</span><span class="p">))</span>

<span class="w">                </span><span class="c">! test on accuracy with partial sum</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">errsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">drl</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Epsabs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">Lst</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">main</span>
<span class="w">                </span><span class="n">correc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">correc</span><span class="p">,</span><span class="w"> </span><span class="n">Erlst</span><span class="p">(</span><span class="n">Lst</span><span class="p">))</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ierlst</span><span class="p">(</span><span class="n">Lst</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">ep</span><span class="p">,</span><span class="w"> </span><span class="n">correc</span><span class="o">*</span><span class="n">p1</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ierlst</span><span class="p">(</span><span class="n">Lst</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">Ier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ier</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">errsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">drl</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">correc</span><span class="o">*</span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">Lst</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">main</span>
<span class="w">                </span><span class="n">numrl2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numrl2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Lst</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">psum</span><span class="p">(</span><span class="n">numrl2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">psum</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Rslst</span><span class="p">(</span><span class="n">Lst</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Lst</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="w">                        </span><span class="c">! test on maximum number of subintervals</span>

<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Lst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Limlst</span><span class="p">)</span><span class="w"> </span><span class="n">Ier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">                        </span><span class="c">! perform new extrapolation</span>

<span class="w">                        </span><span class="k">call </span><span class="n">dqelg</span><span class="p">(</span><span class="n">numrl2</span><span class="p">,</span><span class="w"> </span><span class="n">psum</span><span class="p">,</span><span class="w"> </span><span class="n">reseps</span><span class="p">,</span><span class="w"> </span><span class="n">abseps</span><span class="p">,</span><span class="w"> </span><span class="n">res3la</span><span class="p">,</span><span class="w"> </span><span class="n">nres</span><span class="p">)</span>

<span class="w">                        </span><span class="c">! test whether extrapolated result is influenced by roundoff</span>

<span class="w">                        </span><span class="n">ktmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ktmin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ktmin</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">Abserr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">0.1e-02_wp</span><span class="o">*</span><span class="p">(</span><span class="n">errsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">drl</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">Ier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">abseps</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Abserr</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">Lst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">Abserr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abseps</span>
<span class="w">                            </span><span class="k">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reseps</span>
<span class="w">                            </span><span class="n">ktmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">                            </span><span class="c">! if ier is not 0, check whether direct result (partial sum)</span>
<span class="w">                            </span><span class="c">! or extrapolated result yields the best integral</span>
<span class="w">                            </span><span class="c">! approximation</span>

<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">Abserr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">correc</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Epsabs</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="p">(</span><span class="n">Abserr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Epsabs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">correc</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Epsabs</span><span class="p">))</span><span class="w"> </span><span class="k">exit</span>
<span class="k">                        end if</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="n">Ier</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">Ier</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">                    end if</span>
<span class="k">                else</span>
<span class="k">                    </span><span class="n">psum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rslst</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">                </span><span class="n">ll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numrl2</span>
<span class="w">                </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span>
<span class="w">                </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">            end do</span>

<span class="w">            </span><span class="c">! set final result and error estimate</span>

<span class="w">            </span><span class="n">Abserr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Abserr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">correc</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Ier</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="k">Result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">psum</span><span class="p">(</span><span class="n">numrl2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Abserr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">errsum</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">main</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">psum</span><span class="p">(</span><span class="n">numrl2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>
<span class="k">            end if</span>
<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">Abserr</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="k">Result</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">(</span><span class="n">errsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">drl</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">psum</span><span class="p">(</span><span class="n">numrl2</span><span class="p">)))</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">Ier</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">Ier</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="n">Abserr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Abserr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">drl</span>
<span class="w">                </span><span class="k">return</span>
<span class="k">            end if</span>

<span class="k">        end block </span><span class="n">main</span>

<span class="w">        </span><span class="k">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">psum</span><span class="p">(</span><span class="n">numrl2</span><span class="p">)</span>
<span class="w">        </span><span class="n">Abserr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errsum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">drl</span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">dqawfe</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col"><p>quadpack was developed by Jacob Williams<br>&copy; 2024 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>