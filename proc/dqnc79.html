<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Modern Fortran QUADPACK">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>dqnc79 &ndash; quadpack</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">quadpack </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../sourcefile/quadpack_generic.f90.html">Source File</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
              
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/quadpack_generic.f90.html">Source File</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                                       </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>dqnc79
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.5% of total for procedures.">161 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/quadpack_generic.F90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/quadpack_generic.f90.html'>quadpack_generic.F90</a></li>
     <li><a href='../module/quadpack_generic.html'>quadpack_generic</a></li>
     <li class="active">dqnc79</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dqnc79.html#src">dqnc79</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine dqnc79(fun, a, b, err, ans, ierr, k)</h2>
    

    <p>Integrate a function using a 7-point adaptive Newton-Cotes
  quadrature rule.</p>
<p>DQNC79 is a general purpose program for evaluation of
  one dimensional integrals of user defined functions.
  DQNC79 will pick its own points for evaluation of the
  integrand and these will vary from problem to problem.
  Thus, DQNC79 is not designed to integrate over data sets.
  Moderately smooth integrands will be integrated efficiently
  and reliably.  For problems with strong singularities,
  oscillations etc., the user may wish to use more sophis-
  ticated routines such as those in QUADPACK.  One measure
  of the reliability of DQNC79 is the output parameter <code>K</code>,
  giving the number of integrand evaluations that were needed.</p>
<h3>Author</h3>
<ul>
<li>Kahaner, D. K., (NBS)</li>
<li>Jones, R. E., (SNLA)</li>
</ul>
<h3>Revision history  (YYMMDD)</h3>
<ul>
<li>790601  DATE WRITTEN</li>
<li>890531  Changed all specific intrinsics to generic.  (WRB)</li>
<li>890911  Removed unnecessary intrinsics.  (WRB)</li>
<li>890911  REVISION DATE from Version 3.2</li>
<li>891214  Prologue converted to Version 4.0 format.  (BAB)</li>
<li>900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)</li>
<li>920218  Code redone to parallel QNC79.  (WRB)</li>
<li>930120  Increase array size 80-&gt;99, and KMX 2000-&gt;5000 for SUN -r8 wordlength.  (RWC)</li>
<li>Jacob Williams, Jan 2022 : modernized the SLATEC procedure. added quad-precision coefficients.</li>
</ul>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>This one has a lot of failures in the test cases.</p></div>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-fun"></span>procedure(func)</td>
<td></td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fun</strong></td><td><p>function subprogram defining the integrand function <code>f(x)</code>.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~28"></span>real(kind=wp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>a</strong></td><td><p>lower limit of integration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-b~26"></span>real(kind=wp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>b</strong></td><td><p>upper limit of integration (may be less than <code>A</code>)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-err"></span>real(kind=wp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>err</strong></td><td><p>a requested error tolerance.  Normally, pick a value
<code>0 &lt; ERR &lt; 1.0e-8</code>.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ans~2"></span>real(kind=wp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ans</strong></td><td><p>computed value of the integral.  Hopefully, <code>ANS</code> is
accurate to within <code>ERR *</code> integral of <code>ABS(FUN(X))</code>.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ierr~2"></span>integer,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ierr</strong></td><td><p>a status code:</p>
<ul>
<li>Normal codes</li>
<li><strong>1</strong> <code>ANS</code> most likely meets requested error tolerance.</li>
<li><strong>-1</strong> <code>A</code> and <code>B</code> are too nearly equal to
     allow normal integration. <code>ANS</code> is set to zero.</li>
<li>Abnormal code</li>
<li><strong>2</strong>  <code>ANS</code> probably does not meet requested error tolerance.</li>
</ul></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-k"></span>integer,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>k</strong></td><td><p>the number of function evaluations actually used to do
the integration.  A value of <code>K &gt; 1000</code> indicates a
difficult problem; other programs may be more efficient.
<code>DQNC79</code> will gracefully give up if <code>K</code> exceeds 5000.</p></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/dqnc79.html#src">dqnc79</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">dqnc79</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="n">ans</span><span class="p">,</span><span class="n">ierr</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    procedure</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="c">!! function subprogram defining the integrand function `f(x)`.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="c">!! lower limit of integration</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="c">!! upper limit of integration (may be less than `A`)</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="c">!! a requested error tolerance.  Normally, pick a value</span>
<span class="w">                                </span><span class="c">!! `0 &lt; ERR &lt; 1.0e-8`.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="c">!! computed value of the integral.  Hopefully, `ANS` is</span>
<span class="w">                                </span><span class="c">!! accurate to within `ERR *` integral of `ABS(FUN(X))`.</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="c">!! a status code:</span>
<span class="w">                                </span><span class="c">!!</span>
<span class="w">                                </span><span class="c">!!  * Normal codes</span>
<span class="w">                                </span><span class="c">!!    * **1** `ANS` most likely meets requested error tolerance.</span>
<span class="w">                                </span><span class="c">!!    * **-1** `A` and `B` are too nearly equal to</span>
<span class="w">                                </span><span class="c">!!      allow normal integration. `ANS` is set to zero.</span>
<span class="w">                                </span><span class="c">!!  * Abnormal code</span>
<span class="w">                                </span><span class="c">!!    * **2**  `ANS` probably does not meet requested error tolerance.</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="c">!! the number of function evaluations actually used to do</span>
<span class="w">                             </span><span class="c">!! the integration.  A value of `K &gt; 1000` indicates a</span>
<span class="w">                             </span><span class="c">!! difficult problem; other programs may be more efficient.</span>
<span class="w">                             </span><span class="c">!! `DQNC79` will gracefully give up if `K` exceeds 5000.</span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="mf">1.0_wp</span><span class="o">/</span><span class="mi">14</span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">21</span><span class="mf">6.0_wp</span><span class="o">/</span><span class="mi">14</span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="mf">7.0_wp</span><span class="o">/</span><span class="mi">14</span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">27</span><span class="mf">2.0_wp</span><span class="o">/</span><span class="mi">14</span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0_wp</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ln2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="mf">2.0_wp</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nbits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="n">d1mach</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">i1mach14</span><span class="o">/</span><span class="mf">0.30102000_wp</span><span class="p">)</span><span class="w">  </span><span class="c">!! is 0.30102000 supposed to be log10(2.0_wp) ???</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nlmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">nbits</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nlmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">kml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">kmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span><span class="w">      </span><span class="c">!! JW : is this the max function evals? should be an input</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">array_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span><span class="w"> </span><span class="c">!! JW : what is this magic number 99 array size ??</span>
<span class="w">                                         </span><span class="c">!! does it depend on the number of function evals ?</span>
<span class="w">                                         </span><span class="c">!! (see comment in revision history)</span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ae</span><span class="p">,</span><span class="n">area</span><span class="p">,</span><span class="n">bank</span><span class="p">,</span><span class="n">blocal</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">ce</span><span class="p">,</span><span class="n">ee</span><span class="p">,</span><span class="n">ef</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">q13</span><span class="p">,</span><span class="n">q7</span><span class="p">,</span><span class="n">q7l</span><span class="p">,</span><span class="n">test</span><span class="p">,</span><span class="n">tol</span><span class="p">,</span><span class="n">vr</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">lmn</span><span class="p">,</span><span class="n">lmx</span><span class="p">,</span><span class="n">nib</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">array_size</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">aa</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span><span class="p">,</span><span class="n">f5</span><span class="p">,</span><span class="n">f6</span><span class="p">,</span><span class="n">f7</span><span class="p">,</span><span class="n">hh</span><span class="p">,</span><span class="n">q7r</span><span class="p">,</span><span class="n">vl</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="n">array_size</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lr</span><span class="w"></span>

<span class="w">    </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="c">! JW : this was an error return in the original code</span>

<span class="w">    </span><span class="n">ce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="n">lmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlmx</span><span class="w"></span>
<span class="w">    </span><span class="n">lmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlmn</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="o">/=</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">sign</span><span class="p">(</span><span class="mf">1.0_wp</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">a</span><span class="o">&gt;</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="mf">1.0_wp</span><span class="o">-</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">c</span><span class="o">&lt;=</span><span class="mf">0.1_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">c</span><span class="o">&lt;=</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">                    </span><span class="k">call </span><span class="n">xerror</span><span class="p">(</span><span class="s1">&#39;a and b are too nearly equal to allow normal integration. &#39;</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="o">//</span><span class="s1">&#39;ans is set to zero and ierr to -1.&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">                </span><span class="n">nib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5_wp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">/</span><span class="n">ln2</span><span class="w"></span>
<span class="w">                </span><span class="n">lmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">nlmx</span><span class="p">,</span><span class="n">nbits</span><span class="o">-</span><span class="n">nib</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lmx</span><span class="o">&lt;</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">xerror</span><span class="p">(</span><span class="s1">&#39;a and b are too nearly equal to allow normal integration. &#39;</span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                </span><span class="o">//</span><span class="s1">&#39;ans is set to zero and ierr to -1.&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                end if</span>
<span class="k">                </span><span class="n">lmn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">lmn</span><span class="p">,</span><span class="n">lmx</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span>
<span class="k">        endif</span>
<span class="k">    endif</span>
<span class="k">    </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">),</span><span class="mf">2.0_wp</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="n">nbits</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">err</span><span class="o">==</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">epmach</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tol</span><span class="w"></span>
<span class="w">    </span><span class="n">hh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">1</span><span class="mf">2.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="n">aa</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="w">    </span><span class="n">lr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">        </span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">hh</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="w">    </span><span class="k">enddo</span>
<span class="k">    </span><span class="n">blocal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
<span class="w">    </span><span class="n">f</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">blocal</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="w">    </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="n">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="n">q7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="n">ef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="mf">6.0_wp</span><span class="o">/</span><span class="mi">25</span><span class="mf">5.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="n">bank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>

<span class="w">    </span><span class="n">loop</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">do</span><span class="w"></span>

<span class="w">        </span><span class="c">! compute refined estimates, estimate the error, etc.</span>
<span class="w">        </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">aa</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">hh</span><span class="p">(</span><span class="n">l</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="k">enddo</span>
<span class="k">        </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>

<span class="w">        </span><span class="c">! compute left and right half estimates</span>
<span class="w">        </span><span class="n">q7l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hh</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">w1</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">+</span><span class="n">w2</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span><span class="o">+</span><span class="p">(</span><span class="n">w3</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">+</span><span class="n">w4</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span><span class="w"></span>
<span class="w">        </span><span class="n">q7r</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hh</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">w1</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">+</span><span class="n">w2</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span><span class="o">+</span><span class="p">(</span><span class="n">w3</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">+</span><span class="n">f</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">+</span><span class="n">w4</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="w"></span>

<span class="w">        </span><span class="c">! update estimate of integral of absolute value</span>
<span class="w">        </span><span class="n">area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">area</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">q7l</span><span class="p">)</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">q7r</span><span class="p">(</span><span class="n">l</span><span class="p">))</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">q7</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="c">! do not bother to test convergence before minimum refinement level</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">l</span><span class="o">&gt;=</span><span class="n">lmn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>

<span class="w">            </span><span class="c">! estimate the error in new value for whole interval, q13</span>
<span class="w">            </span><span class="n">q13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q7l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q7r</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">q7</span><span class="o">-</span><span class="n">q13</span><span class="p">)</span><span class="o">*</span><span class="n">ef</span><span class="w"></span>

<span class="w">            </span><span class="c">! compute nominal allowed error</span>
<span class="w">            </span><span class="n">ae</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="n">area</span><span class="w"></span>

<span class="w">            </span><span class="c">! borrow from bank account, but not too much</span>
<span class="w">            </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">ae</span><span class="o">+</span><span class="mf">0.8_wp</span><span class="o">*</span><span class="n">bank</span><span class="p">,</span><span class="mi">1</span><span class="mf">0.0_wp</span><span class="o">*</span><span class="n">ae</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="c">! don&#39;t ask for excessive accuracy</span>
<span class="w">            </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="n">tol</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">q13</span><span class="p">),</span><span class="mf">0.00003_wp</span><span class="o">*</span><span class="n">tol</span><span class="o">*</span><span class="n">area</span><span class="p">)</span><span class="w">   </span><span class="c">! jw : should change ?</span>

<span class="w">            </span><span class="c">! now, did this interval pass or not?</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ee</span><span class="o">&lt;=</span><span class="n">test</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">! on good intervals accumulate the theoretical estimate</span>
<span class="w">                </span><span class="n">ce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ce</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">q7</span><span class="o">-</span><span class="n">q13</span><span class="p">)</span><span class="o">/</span><span class="mi">25</span><span class="mf">5.0_wp</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"></span>
<span class="w">                </span><span class="c">! consider the left half of next deeper level</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">&gt;</span><span class="n">kmx</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">lmx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">kml</span><span class="p">,</span><span class="n">lmx</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">l</span><span class="o">&lt;</span><span class="n">lmx</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">f200</span><span class="p">()</span><span class="w"></span>
<span class="w">                    </span><span class="k">cycle </span><span class="n">loop</span><span class="w"></span>
<span class="w">                </span><span class="k">end if</span><span class="w"></span>
<span class="w">                </span><span class="c">! have hit maximum refinement level -- penalize the cumulative error</span>
<span class="w">                </span><span class="n">ce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ce</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">q7</span><span class="o">-</span><span class="n">q13</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">endif</span><span class="w"></span>

<span class="w">            </span><span class="c">! update the bank account.  don&#39;t go into debt.</span>
<span class="w">            </span><span class="n">bank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bank</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">ae</span><span class="o">-</span><span class="n">ee</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bank</span><span class="o">&lt;</span><span class="mf">0.0_wp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">bank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>

<span class="w">            </span><span class="c">! did we just finish a left half or a right half?</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                </span><span class="c">! proceed to right half at this level</span>
<span class="w">                </span><span class="n">vl</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q13</span><span class="w"></span>
<span class="w">                </span><span class="k">call </span><span class="n">f300</span><span class="p">()</span><span class="w"></span>
<span class="w">                </span><span class="k">cycle </span><span class="n">loop</span><span class="w"></span>
<span class="w">            </span><span class="k">else</span><span class="w"></span>
<span class="w">                </span><span class="c">! left and right halves are done, so go back up a level</span>
<span class="w">                </span><span class="n">vr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q13</span><span class="w"></span>
<span class="w">                </span><span class="k">do</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">l</span><span class="o">&lt;=</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="w">                        </span><span class="c">!   exit</span>
<span class="w">                        </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vr</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">ce</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">2.0_wp</span><span class="o">*</span><span class="n">tol</span><span class="o">*</span><span class="n">area</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">ierr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">xerror</span><span class="p">(</span><span class="s1">&#39;ans is probably insufficiently accurate.&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>
<span class="k">                        return</span>
<span class="k">                    else</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">l</span><span class="o">&lt;=</span><span class="mi">17</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">ef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ef</span><span class="o">*</span><span class="n">sq2</span><span class="w"></span>
<span class="w">                        </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="mf">2.0_wp</span><span class="w"></span>
<span class="w">                        </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            </span><span class="n">vl</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vl</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vr</span><span class="w"></span>
<span class="w">                            </span><span class="k">call </span><span class="n">f300</span><span class="p">()</span><span class="w"></span>
<span class="w">                            </span><span class="k">cycle </span><span class="n">loop</span><span class="w"></span>
<span class="w">                        </span><span class="k">else</span>
<span class="k">                            </span><span class="n">vr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vl</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vr</span><span class="w"></span>
<span class="w">                        </span><span class="k">endif</span>
<span class="k">                    endif</span>
<span class="k">                end do</span>
<span class="k">            endif</span>
<span class="k">        endif</span>

<span class="k">        call </span><span class="n">f200</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="k">end do </span><span class="n">loop</span><span class="w"></span>

<span class="w">    </span><span class="k">contains</span>

<span class="k">        subroutine </span><span class="n">f200</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="mf">0.5_wp</span><span class="w"></span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">l</span><span class="o">&lt;=</span><span class="mi">17</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">ef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ef</span><span class="o">/</span><span class="n">sq2</span><span class="w"></span>
<span class="w">            </span><span class="n">hh</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hh</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5_wp</span><span class="w"></span>
<span class="w">            </span><span class="n">lr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">aa</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aa</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">q7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q7l</span><span class="w"></span>
<span class="w">            </span><span class="n">f1</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f2</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f3</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f4</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f5</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f6</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f7</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">f200</span><span class="w"></span>

<span class="w">        </span><span class="k">subroutine </span><span class="n">f300</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="n">q7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q7r</span><span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">lr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">aa</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aa</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="mf">2.0_wp</span><span class="o">*</span><span class="n">hh</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f1</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f2</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f3</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f4</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f5</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f6</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">f</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f7</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">f300</span><span class="w"></span>

<span class="w">    </span><span class="k">end subroutine </span><span class="n">dqnc79</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>quadpack was developed by Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>